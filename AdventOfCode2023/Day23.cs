namespace AdventOfCode2023;

public static class Day23
{
    public static void Solve()
    {
        Console.WriteLine("Day 23");
        Console.WriteLine($"Part 1: {Part1()}"); //2306
        Console.WriteLine($"Part 2: {Part2()}"); //6718
    }

    public static long Part1()
    {
        var input = _input.AsSpan();
        var lineLength = input.IndexOf(Environment.NewLine[0]);
        var lineWidth = lineLength + Environment.NewLine.Length;

        var start = input.IndexOf('.');
        var finish = input.LastIndexOf('.');

        var distances = new int[input.Length];

        var queue = new Stack<(int Index, int Source, int Distance)>();
        queue.Push((start + lineWidth, start, 1));
        Span<int> neighbors = stackalloc int[4];
        while (queue.Count > 0)
        {
            var (index, source, distance) = queue.Pop();
            if (index == finish)
            {
                continue;
            }

            var neighborsCount = 0;
            if (input[index] != '.')
            {
                var next = input[index] switch
                {
                    '>' => index + 1,
                    '^' => index - lineWidth,
                    'v' => index + lineWidth,
                    '<' => index - 1,
                    _ => throw new()
                };
                neighbors[neighborsCount++] = next;
            }
            else
            {
                neighbors[neighborsCount++] = index - lineWidth;
                neighbors[neighborsCount++] = index + lineWidth;
                neighbors[neighborsCount++] = index - 1;
                neighbors[neighborsCount++] = index + 1;
            }

            for (var nI = 0; nI < neighborsCount; nI++)
            {
                var neighborIndex = neighbors[nI];
                if (input[neighborIndex] == '#' || neighborIndex == source) continue;

                var newDistance = distance + 1;
                if (newDistance > distances[neighborIndex])
                {
                    distances[neighborIndex] = newDistance;
                    queue.Push((neighborIndex, index, newDistance));
                }
            }
        }

        return distances[finish];
    }

    public static long Part2()
    {
        var input = _input.AsSpan();
        var lineLength = input.IndexOf(Environment.NewLine[0]);
        var lineWidth = lineLength + Environment.NewLine.Length;

        var start = input.IndexOf('.');
        var finish = input.LastIndexOf('.');

        var graph = new Dictionary<int, HashSet<(int Vertex, int Distance)>?>();
        graph[start] = new();

        var visited = new HashSet<int> {start};
        var queue = new Stack<(int Current, int Previous, (int Distance, int From))>();
        queue.Push((start + lineWidth, start, (1, start)));
        Span<int> neighbors = stackalloc int[4];
        while (queue.Count > 0)
        {
            var (current, last, (distance, from)) = queue.Pop();
            if (current == finish)
            {
                graph[from]!.Add((current, distance));
                continue;
            }

            var neighborsCount = 0;
            var up = current - lineWidth;
            if (input[up] != '#' && last != up)
            {
                neighbors[neighborsCount++] = up;
            }

            var down = current + lineWidth;
            if (input[down] != '#' && last != down)
            {
                neighbors[neighborsCount++] = down;
            }

            var left = current - 1;
            if (input[left] != '#' && last != left)
            {
                neighbors[neighborsCount++] = left;
            }

            var right = current + 1;
            if (input[right] != '#' && last != right)
            {
                neighbors[neighborsCount++] = right;
            }

            if (neighborsCount > 1)
            {
                graph.TryAdd(current, []);
                graph[from]!.Add((current, distance));
                graph[current]!.Add((from, distance));

                distance = 0;
                from = current;
            }
            else
            {
                visited.Add(current);
            }

            for(var nI = 0; nI < neighborsCount; nI++)
            {
                var neighbor = neighbors[nI];
                if (visited.Contains(neighbor)) continue;

                var newDistance = distance + 1;
                queue.Push((neighbor, current, (newDistance, from)));
            }
        }

        var distances = graph.ToDictionary(x => x.Key, _ => 0);
        distances[finish] = 0;

        Span<int> path = stackalloc int[graph.Count];
        var priorityQueue = new Stack<(int Index, int PathLength, int Distance)>();
        priorityQueue.Push((start,0, 0));
        var maxDistance = 0;
        while (priorityQueue.Count > 0)
        {
            var (index, pathLength, distance) = priorityQueue.Pop();
            if (index == finish)
            {
                if (distance > maxDistance)
                {
                    maxDistance = distance;
                }

                continue;
            }

            path[pathLength] = index;
            foreach (var neighbor in graph[index]!)
            {
                if (path[..pathLength].Contains(neighbor.Vertex)) continue;

                var newDistance = distance + neighbor.Distance;
                priorityQueue.Push((neighbor.Vertex, pathLength+1, newDistance));
            }
        }

        return maxDistance;
    }

    private const string _testInput = """
                                      #.#####################
                                      #.......#########...###
                                      #######.#########.#.###
                                      ###.....#.>.>.###.#.###
                                      ###v#####.#v#.###.#.###
                                      ###.>...#.#.#.....#...#
                                      ###v###.#.#.#########.#
                                      ###...#.#.#.......#...#
                                      #####.#.#.#######.#.###
                                      #.....#.#.#.......#...#
                                      #.#####.#.#.#########v#
                                      #.#...#...#...###...>.#
                                      #.#.#v#######v###.###v#
                                      #...#.>.#...>.>.#.###.#
                                      #####v#.#.###v#.#.###.#
                                      #.....#...#...#.#.#...#
                                      #.#########.###.#.#.###
                                      #...###...#...#...#.###
                                      ###.###.#.###v#####v###
                                      #...#...#.#.>.>.#.>.###
                                      #.###.###.#.###.#.#v###
                                      #.....###...###...#...#
                                      #####################.#
                                      """;

    private const string _input = """
                                  #.###########################################################################################################################################
                                  #.#...###.......###...#...#...#...............#...#.......#...#####.....#.........#...#...#...#.....#...#...#...#...#...#.........#.....#...#
                                  #.#.#.###.#####.###.#.#.#.#.#.#.#############.#.#.#.#####.#.#.#####.###.#.#######.#.#.#.#.#.#.#.###.#.#.#.#.#.#.#.#.#.#.#.#######.#.###.#.#.#
                                  #.#.#.#...#.....#...#...#.#.#.#.....#.........#.#.#.#.....#.#...###.#...#.....#...#.#.#.#.#.#.#.#...#.#.#.#.#.#.#.#.#.#.#...#.....#.#...#.#.#
                                  #.#.#.#.###.#####.#######.#.#.#####.#.#########.#.#.#.#####.###.###.#.#######.#.###.#.#.#.#.#.#.#.###.#.#.#.#.#.#.#.#.#.###.#.#####.#.###.#.#
                                  #...#.#.#...###...#.....#.#.#.>.>...#.#...#...#.#.#.#.....#.#...#...#...#.....#...#.#...#.#.#.#.#...#.#...#.#.#.#.#.#.#.#...#...#...#.#...#.#
                                  #####.#.#.#####.###.###.#.#.###v#####.#.#.#.#.#.#.#.#####.#.#.###.#####.#.#######.#.#####.#.#.#.###.#.#####.#.#.#.#.#.#.#.#####.#.###.#.###.#
                                  #.....#.#.....#.....#...#.#.###...#...#.#.#.#.#.#.#.#.....#.#.###...#...#.....#...#...#...#.#.#...#.#.#.....#.#.#.#.#.#.#.#.....#...#.#.#...#
                                  #.#####.#####.#######.###.#.#####.#.###.#.#.#.#.#.#.#.#####.#.#####.#.#######.#.#####.#.###.#.###.#.#.#.#####.#.#.#.#.#.#.#.#######.#.#.#.###
                                  #.#...#.#.....#.......###...#.....#...#.#.#.#.#.#.#.#.#...#.#.>.>.#.#.#...###.#.###...#...#.#...#.#...#.>.>.#.#.#.#.#.#.#.#.#...#...#...#...#
                                  #.#.#.#.#.#####.#############.#######.#.#.#.#.#.#.#.#.#.#.#.###v#.#.#.#.#.###.#.###.#####.#.###.#.#######v#.#.#.#.#.#.#.#.#.#.#.#.#########.#
                                  #.#.#...#.....#.#...........#.......#.#.#.#.#...#.#.#...#.#.###.#.#.#.#.#.#...#.>.>.#.....#...#.#.#.......#...#.#.#...#.#.#.#.#.#.#.........#
                                  #.#.#########.#.#.#########.#######.#.#.#.#.#####.#.#####.#.###.#.#.#.#.#.#.#####v###.#######.#.#.#.###########.#.#####.#.#.#.#.#.#.#########
                                  #.#.#.........#...#.....#...#.......#.#.#.#...#...#.#.....#.#...#...#.#.#...#...#...#.#.....#.#...#.......#...#.#...#...#.#...#...#.........#
                                  #.#.#.#############.###.#.###.#######.#.#.###.#.###.#.#####.#.#######.#.#####.#.###.#.#.###.#.###########.#.#.#.###.#.###.#################.#
                                  #.#.#...#...#...#...#...#.###...#...#...#...#.#.#...#...#...#.......#.#.#.....#.....#.#...#.#.....#######...#.#.....#...#...#...............#
                                  #.#.###.#.#.#.#.#.###.###.#####.#.#.#######.#.#.#.#####.#.#########.#.#.#.###########.###.#.#####.###########.#########.###.#.###############
                                  #.#.#...#.#.#.#.#...#...#.....#...#.......#.#.#.#.###...#.#.........#...#...........#...#.#...#...#.........#...#.......#...#.........#...###
                                  #.#.#.###.#v#.#.###.###.#####.###########.#.#.#.#.###.###.#.#######################.###.#.###.#.###.#######.###.#.#######.###########.#.#.###
                                  #...#.....#.>.#...#.###.......#...#.......#...#...#...#...#.......#...#...#.......#...#.#...#.#.#...#.....#...#.#.#...#...#.........#...#...#
                                  ###########v#####.#.###########.#.#.###############.###.#########.#.#.#.#.#.#####.###.#.###.#.#.#.###.###.###.#.#.#.#.#.###.#######.#######.#
                                  #.........#...#...#.....#...#...#.#.#...###...#...#...#.###...#...#.#.#.#.#.....#.#...#...#.#...#.....###...#...#...#...###.......#.#.......#
                                  #.#######.###.#.#######.#.#.#.###.#.#.#.###.#.#.#.###.#.###.#.#.###.#.#.#.#####.#.#.#####.#.###############.#####################.#.#.#######
                                  #.......#.....#.......#.#.#.#...#.#...#...#.#...#...#...#...#.#...#.#.#.#.......#...#...#...###...#.........#...#...#.......#.....#...#...###
                                  #######.#############.#.#.#.###.#.#######.#.#######.#####.###.###.#.#.#.#############.#.#######.#.#.#########.#.#.#.#.#####.#.#########.#.###
                                  #...###...........###...#.#.....#.........#.#.......#...#...#.#...#.#.#...#...#.......#.#...#...#.#...........#...#.#.....#.#.....#...#.#...#
                                  #.#.#############.#######.#################.#.#######.#.###.#.#.###.#.###.#.#.#.#######.#.#.#.###.#################.#####.#.#####.#.#.#.###.#
                                  #.#.#.......#.....#.......#...#.........#...#.#...#...#.#...#.#.#...#.###...#.#.#.......#.#.#.#...#...###...........#...#.#.#...#...#...#...#
                                  #.#.#.#####.#.#####.#######.#.#.#######.#.###.#.#.#.###.#.###.#.#.###.#######v#.#.#######.#.#.#.###.#.###.###########.#.#.#.#.#.#########.###
                                  #.#.#.#...#...#...#.#...#...#...###...#.#.#...#.#.#...#.#...#.#.#...#.#...#.>.>.#.....#...#.#.#.#...#.....#...#.......#.#.#...#.......#...###
                                  #.#.#.#.#v#####.#.#.#.#.#.#########.#.#.#.#.###.#.###.#.###.#.#v###.#.#.#.#.#v#######.#.###.#.#.#.#########.#.#.#######.#.###########.#.#####
                                  #.#.#...#.>.###.#.#...#...#...#.....#...#.#...#.#.#...#.#...#.>.>...#.#.#...#.#.......#.#...#.#.#...#.......#.#.....#...#.........###...#...#
                                  #.#.#####v#.###.#.#########.#.#.#########.###.#.#.#.###.#.#####v#####.#.#####.#.#######.#.###.#.###.#.#######.#####.#.###########v#######.#.#
                                  #.#.#.....#.....#.......###.#.#.......#...#...#.#.#...#.#.#####.....#.#...#...#...#...#.#.###.#.###...###.....#...#.#...#.....#.>.#.......#.#
                                  #.#.#.#################.###.#.#######.#.###.###.#.###.#.#.#########.#.###.#.#####.#.#.#.#.###.#.#########.#####.#.#.###.#.###.#.#v#.#######.#
                                  #.#.#.....###...........#...#.#...#...#...#.....#...#.#.#.#.........#.#...#.....#.#.#.#.#...#.#.#...#...#.#...#.#...#...#.###...#.#.#.......#
                                  #.#.#####.###.###########.###.#.#.#.#####.#########.#.#.#.#.#########.#.#######.#.#.#.#.###.#.#.#.#.#.#.#v#.#.#.#####.###.#######.#.#.#######
                                  #.#.#.....#...###...#...#...#.#.#.#.#...#.#.......#.#.#...#.........#.#.#...#...#.#.#.#.#...#.#.#.#.#.#.>.>.#.#.....#.....#.....#...#...#...#
                                  #.#.#.#####.#####.#.#.#.###.#.#.#.#.#.#.#.#.#####.#.#.#############.#.#.#.#.#.###.#.#.#.#.###.#.#.#.#.###v###.#####.#######.###.#######.#.#.#
                                  #.#.#.....#...#...#.#.#.###.#.#.#.#.#.#.#...#.....#.#.#.............#...#.#...###.#.#.#.#.#...#...#.#.#...###.#.....#.......#...#.....#...#.#
                                  #.#.#####.###.#.###.#.#.###.#.#.#.#v#.#.#####.#####.#.#.#################.#######.#.#.#.#.#.#######.#.#.#####.#.#####.#######.###.###.#####.#
                                  #.#.#.....###.#.#...#.#...#.#.#.#.>.>.#.#...#.....#...#...............###.......#...#.#.#.#.....###...#.....#.#.....#...#...#.....###...#...#
                                  #.#.#.#######.#.#.###.###.#.#.#.###v###.#.#.#####.###################.#########.#####.#.#.#####.###########.#.#####.###.#.#.###########.#.###
                                  #.#.#.......#...#...#...#.#.#.#.#...###...#.#...#.....#...............#.........#...#.#.#.#...#.#.......#...#.....#.###...#.........#...#.###
                                  #.#.#######.#######.###.#.#.#.#.#.#########.#.#.#####.#.###############.#########.#.#.#.#.#.#.#.#.#####.#.#######.#.###############.#.###.###
                                  #.#.........###.....#...#.#.#...#.......###...#.......#.............###...........#.#...#.#.#.#.#.....#...###...#...#...............#.....###
                                  #.#############.#####.###.#.###########.###########################.###############.#####.#.#.#.#####.#######.#.#####.#######################
                                  #.#.......#...#...#...###.#...#.........#...#...#######.............#.....###.....#.....#.#.#...#...#.......#.#.....#...........#.....#...###
                                  #.#.#####.#.#.###.#.#####.###.#.#########.#.#.#.#######.#############.###.###.###.#####.#.#.#####.#.#######.#.#####.###########.#.###.#.#.###
                                  #.#.#.....#.#.###.#.#...#.....#.#...#.....#...#...###...#.......#...#...#.....###.......#.#...#...#.........#.#.....#...........#.#...#.#...#
                                  #.#.#.#####.#.###.#.#.#.#######.#.#.#.###########.###.###.#####.#.#.###.#################.###.#.#############.#.#####.###########.#.###.###.#
                                  #.#.#.#...#.#...#...#.#.###...#...#...#.....#...#...#.....#...#...#...#...#...........#...#...#...............#.#...#.............#...#...#.#
                                  #.#.#.#.#.#.###.#####.#.###.#.#########.###.#.#.###.#######.#.#######.###.#.#########.#.###.###################.#.#.#################.###.#.#
                                  #...#.#.#.#.#...#...#.#.#...#.###.....#...#...#.....###.....#.#.......#...#.#.........#.....#.....#.............#.#.#...............#.....#.#
                                  #####v#.#.#.#.###.#.#.#.#.###.###.###.###.#############.#####.#.#######.###.#.###############.###.#.#############.#.#.#############.#######.#
                                  #...#.>.#.#.#...#.#.#.#.#...#...#...#.....###...#.....#.....#...#...###.#...#.......#...#...#.#...#.............#.#.#.......###...#...#...#.#
                                  #.#.#v###.#.###.#.#.#.#.###.###.###.#########.#.#.###.#####.#####.#.###.#.#########.#.#.#.#.#.#.###############.#.#.#######.###.#.###.#.#.#.#
                                  #.#.#...#.#...#...#...#...#.#...###.........#.#.#.#...#...#.#...#.#...#...#.........#.#.#.#.#.#.#...#...........#.#.#.....#.....#.#...#.#.#.#
                                  #.#.###.#.###.###########.#.#.#############.#.#.#.#.###.#.#v#.#.#.###.#####.#########.#.#.#.#.#.#.#.#.###########.#.#.###.#######.#.###.#.#.#
                                  #.#.#...#...#.#...........#.#.#...#...#.....#.#.#.#.#...#.>.>.#.#.#...#...#...#...###.#.#.#.#.#.#.#.#.....###...#.#.#.#...#...#...#.....#.#.#
                                  #.#.#.#####.#.#.###########.#.#.#.#.#.#v#####.#.#.#.#.#####v###.#.#.###.#.###v#.#.###.#.#.#.#.#.#.#.#####v###.#.#.#.#.#.###v#.#.#########.#.#
                                  #.#...#...#.#.#...#.......#.#.#.#.#.#.>.>...#.#.#.#...#####...#.#.#...#.#.#.>.>.#...#.#.#.#.#.#.#.#...#.>.>.#.#.#.#...#.#.>.#...###.....#...#
                                  #.#####.#.#.#.###.#.#####.#.#.#.#.#.###v###.#.#.#.###########.#.#.###.#.#.#.#v#####.#.#.#.#.#.#.#.###.#.#v#.#.#.#.#####.#.#v#######.###.#####
                                  #.#.....#.#...#...#.#.....#.#.#.#...###...#.#.#.#.#...#.......#...#...#.#...#.....#.#.#.#.#.#.#.#...#.#.#.#...#.#...###.#.#...#...#...#.....#
                                  #.#.#####.#####.###.#.#####.#.#.#########.#.#.#.#.#.#.#.###########.###.#########.#.#.#.#.#.#.#.###.#.#.#.#####.###.###.#.###.#.#.###.#####.#
                                  #.#.#.....#...#.....#.....#.#.#.......###.#...#.#...#.#...........#...#.#.........#...#.#.#.#.#.#...#.#.#.#...#.....#...#.#...#.#.#...#...#.#
                                  #.#.#.#####.#.###########.#.#.#######.###.#####.#####.###########.###.#.#.#############.#.#.#.#.#.###.#.#.#.#.#######.###.#.###.#.#.###.#.#.#
                                  #...#.......#...........#.#.#...#...#.#...###...#...#.#...........###.#.#.#...###.....#.#.#.#.#.#.#...#.#...#...#...#...#.#.....#...#...#...#
                                  #######################.#.#.###.#.#.#.#.#####.###.#.#.#.#############.#.#.#.#.###.###.#.#.#.#.#.#.#.###.#######.#.#.###.#.###########.#######
                                  #.................#.....#.#.#...#.#...#.....#.#...#...#.#...........#...#...#.....#...#...#...#...#...#.#.......#.#.###...#...........###...#
                                  #.###############.#.#####.#.#.###.#########.#.#.#######.#.#########.###############.#################.#.#.#######.#.#######.#############.#.#
                                  #...............#.#.#...#...#...#.....#.....#.#.....###...#.........#.....#.........#...#...#.....###...#...#.....#.......#.#.............#.#
                                  ###############.#.#.#.#.#######.#####.#.#####.#####.#######.#########.###.#.#########.#.#.#.#.###.#########.#.###########.#.#.#############.#
                                  #...............#...#.#.#.....#.#.....#.....#.......#...###.....#...#...#.#.......#...#.#.#.#.#...#...#.....#.#.....#.....#...#...#.........#
                                  #.###################.#.#.###.#.#.#########.#########.#.#######.#.#.###.#.#######.#.###.#.#.#.#.###.#.#.#####.#.###.#.#########v#.#.#########
                                  #.#...........#...#...#...#...#...#.....#...#...#...#.#.#.......#.#...#.#.###.....#.#...#.#...#...#.#.#.....#.#...#...#.......>.#...###...###
                                  #.#.#########.#.#.#.#######.#######.###.#.###.#.#.#.#.#.#.#######.###.#.#.###v#####.#.###.#######.#.#.#####.#.###.#####.#######v#######.#.###
                                  #.#.#.........#.#.#.......#.#...###...#...#...#.#.#.#.#.#.....###.#...#.#.#.>.>.....#...#...#.....#.#.....#...###...###.......#...#.....#...#
                                  #.#.#.#########.#.#######.#.#.#.#####.#####.###.#.#.#.#.#####v###.#.###.#.#.#v#########.###.#.#####.#####.#########.#########.###.#.#######.#
                                  #.#.#.#...#...#.#.#...###.#.#.#.#...#.....#...#.#.#.#.#.#...>.>.#.#.#...#.#.#.#.....#...#...#.....#.#.....###.......#...#.....#...#.#.......#
                                  #.#.#.#.#.#.#.#.#.#.#.###.#.#.#.#.#.#####v###.#.#.#.#.#.#.###v#.#.#.#.###.#.#.#.###.#.###.#######.#.#.#######.#######.#.#.#####.###.#.#######
                                  #...#...#.#.#.#.#.#.#...#.#.#.#.#.#.#...>.>...#...#.#.#...#...#...#.#.#...#.#...#...#.#...#.......#.#...#...#.....#...#.#.....#.....#.......#
                                  #########v#.#.#.#.#.###.#.#.#.#.#.#.#.###v#########.#.#####.#######.#.#.###.#####.###.#.###.#######.###.#.#.#####.#.###.#####.#############.#
                                  ###...###.>.#.#.#.#...#.#.#.#.#.#.#.#...#...#...###...#.....#.....#...#...#...#...###.#.###...#...#.#...#.#.#...#.#...#.....#.#.............#
                                  ###.#.###v###.#.#.###.#.#.#.#.#.#.#.###.###.#.#.#######.#####.###.#######.###.#.#####.#.#####.#.#.#.#.###.#.#.#.#.###.#####.#.#.#############
                                  #...#.#...###.#.#.#...#...#.#.#.#.#...#.###...#...#...#.......#...#.......#...#.....#.#.#.....#.#...#.#...#...#.#.###.....#...#.............#
                                  #.###.#.#####.#.#.#.#######.#.#.#.###.#.#########.#.#.#########.###.#######.#######.#.#.#.#####.#####.#.#######.#.#######.#################.#
                                  #...#.#.....#...#.#.......#...#.#...#.#.#.........#.#...###.....###...#...#.#####...#...#.#...#...#...#.#.......#.#...###...#...............#
                                  ###.#.#####.#####.#######.#####.###.#.#.#.#########.###.###.#########.#.#.#.#####.#######.#.#.###.#.###.#.#######v#.#.#####.#.###############
                                  #...#.......###...#...#...#.....#...#...#.........#...#.....#...#####.#.#.#.#.....#.......#.#...#.#...#.#.#...#.>.>.#...#...#...............#
                                  #.#############.###.#.#.###.#####.###############.###.#######.#.#####.#.#.#.#.#####.#######.###.#.###.#.#.#.#.#.#v#####.#.#################.#
                                  #.............#.....#...###...#...#...........#...###.#.......#.....#...#.#.#.....#.......#.#...#...#...#...#.#.#.....#.#.#.............#...#
                                  #############.###############.#.###.#########.#.#####.#.###########.#####.#.#####.#######.#.#.#####.#########.#.#####.#.#.#.###########.#.###
                                  #.............#...#####.....#.#...#.........#.#.#.....#.#...........#...#...#...#.......#.#.#.#...#.......###...#.....#...#...........#...###
                                  #.#############.#.#####.###.#.###.#########.#.#.#.#####.#.###########.#.#####.#.#######.#.#.#.#.#.#######.#######.###################.#######
                                  #...............#.......#...#...#.#.........#.#.#.......#.............#...#...#.........#...#.#.#.#.......#.......#...###.......#...#.......#
                                  #########################.#####.#.#.#########.#.#########################.#.#################.#.#.#.#######.#######.#.###.#####.#.#.#######.#
                                  #.........................#...#.#.#.........#...#...#.....................#.......#...#...###...#...#.......#.......#...#.#...#...#.#.....#.#
                                  #.#########################.#.#.#.#########.#####.#.#.###########################.#.#.#.#.###########.#######.#########.#.#.#.#####.#.###.#.#
                                  #.............#...#...#...#.#.#...#.......#...###.#.#...................###...###...#.#.#.#.....#.....#.......###.....#.#...#.....#.#...#...#
                                  #############.#.#.#.#.#.#.#.#.#####.#####.###.###.#.###################.###.#.#######.#.#.#.###.#.#####.#########.###.#.#########.#.###.#####
                                  #...#...#.....#.#.#.#...#...#.#...#.....#.....#...#.#.....#.............#...#.......#...#...#...#.......#.....#...###...#.........#.....#...#
                                  #.#.#.#.#v#####.#.#.#########.#.#.#####.#######.###.#.###.#.#############.#########.#########.###########.###.#.#########.###############.#.#
                                  #.#...#.#.>.###.#.#...#.......#.#.#...#.....###...#.#...#.#.#...#.......#.........#.#...#...#...#...#...#.#...#...#...###...............#.#.#
                                  #.#####.#v#.###.#.###.#.#######.#.#.#.#####.#####.#.###.#.#v#.#.#.#####.#########.#.#.#.#.#.###.#.#.#.#.#.#.#####.#.#.#################.#.#.#
                                  #.#...#...#...#.#.#...#.......#.#.#.#.#.....#...#.#.....#.>.>.#.#.#.....#...#.....#...#...#.....#.#.#.#.#.#.#.....#.#.....#.............#.#.#
                                  #.#.#.#######.#.#.#.#########.#.#.#.#.#.#####.#.#.#########v###.#.#.#####.#.#.###################.#.#.#.#.#.#.#####.#####.#.#############.#.#
                                  #.#.#...#...#...#.#.#.........#.#.#.#.#.....#.#...###.....#.#...#.#.#...#.#.#.....#...###...#...#.#.#.#.#.#.#.....#.....#.#.......#...#...#.#
                                  #.#.###.#.#.#####.#.#.#########.#.#.#.#####.#.#######.###.#.#.###.#.#.#.#.#.#####v#.#.###.#.#.#.#.#.#.#.#.#.#####v#####.#.#######.#.#.#.###.#
                                  #.#.###...#.....#.#.#...#...###.#.#.#.#...#.#.....#...###.#.#...#.#.#.#.#.#.....>.>.#.#...#.#.#...#.#.#.#.#.#...>.>.###.#.#.....#...#...#...#
                                  #.#.###########.#.#.###.#.#.###.#.#.#.#.#.#v#####.#.#####.#.###.#.#.#.#.#.#######v###.#.###.#.#####.#.#.#.#.#.###v#.###.#.#.###.#########.###
                                  #...#...#.......#...###.#.#...#.#.#.#.#.#.>.>.#...#.....#...#...#.#.#.#...###...#.#...#.#...#.....#.#.#.#.#...#...#...#.#.#...#...........###
                                  #####.#.#.#############.#.###.#.#.#.#.#.###v#.#.#######.#####.###.#.#.#######.#.#.#.###.#.#######.#.#.#.#.#####.#####.#.#.###v###############
                                  #.....#.#.......#.......#.###.#.#.#.#...###.#.#...#.....###...#...#.#.#.......#...#...#.#...#.....#.#.#.#.#.....#...#...#.#.>.#.......#...###
                                  #.#####.#######.#.#######.###.#.#.#.#######.#.###.#.#######.###.###.#.#.#############.#.###.#.#####.#.#.#.#.#####.#.#####.#.#v#.#####.#.#.###
                                  #.#...#.........#.....#...#...#.#.#.###.....#.#...#.......#...#...#.#.#.....#...#####...###.#.....#.#.#...#.......#.....#...#...#...#...#...#
                                  #.#.#.###############.#.###.###.#.#.###.#####.#.#########.###.###.#.#.#####.#.#.###########.#####.#.#.#################.#########.#.#######.#
                                  #...#...............#.#.###.....#.#.#...#...#...#...#.....###.....#...#...#...#.........#...#...#.#.#.#.......#...#...#.#.........#.........#
                                  ###################.#.#.#########.#.#.###.#.#####.#.#.#################.#.#############.#.###.#.#.#.#.#.#####.#.#.#.#.#.#.###################
                                  #...................#.#.#...#...#...#.....#.....#.#...#...#...#...#...#.#.#...#.........#.#...#...#.#.#.....#...#...#...#...#...............#
                                  #.###################.#.#.#.#.#.###############.#.#####.#.#.#.#.#.#.#.#.#.#.#.#.#########.#.#######.#.#####.###############.#.#############.#
                                  #...................#.#.#.#...#...#.............#.......#.#.#.#.#.#.#...#...#.#.....#...#...#...###...#.....#...###.......#...#...#.........#
                                  ###################.#.#.#.#######.#.#####################.#.#.#.#.#.#########.#####.#.#.#####.#.#######.#####.#.###.#####.#####.#.#.#########
                                  #...................#...#.....#...#.#...#.........#.....#.#.#...#.#.#.......#.......#.#.....#.#.#.....#.......#...#.....#.......#...#.......#
                                  #.###########################.#.###.#.#.#.#######.#.###.#.#.#####.#.#.#####.#########.#####.#.#.#.###.###########.#####.#############.#####.#
                                  #.....#...........#...###...#.#...#...#...#.......#...#...#.#.....#...#.....#...###...#.....#.#.#...#.#...........#...#.....#.........#.....#
                                  #####.#.#########.#.#.###.#.#.###.#########.#########v#####.#.#########.#####.#.###.###.#####.#.###.#.#.###########.#.#####.#.#########.#####
                                  #...#...###.......#.#.###.#.#...#.#...#.....#.....#.>.>.###.#.#####...#.....#.#.###.#...#...#.#...#.#.#.............#...###...###.......#...#
                                  #.#.#######.#######.#.###.#.###.#.#.#.#.#####.###.#.###.###.#.#####.#.#####v#.#.###.#.###.#.#.###.#.#.#################.#########.#######.#.#
                                  #.#.#...#...###...#.#.#...#...#.#.#.#.#.#...#...#.#.###.#...#...#...#...#.>.>.#...#.#.....#.#.#...#.#...#...............#.........###.....#.#
                                  #.#.#.#.#.#####.#.#.#.#.#####.#.#.#.#.#.#.#.###.#.#.###.#.#####.#.#####.#.#######.#.#######.#.#.###.###.#.###############.###########.#####.#
                                  #.#...#...#...#.#.#.#.#...#...#.#.#.#.#...#.#...#.#.#...#.#.....#...#...#.#######...#.....#.#.#.....#...#...............#...........#.#...#.#
                                  #.#########.#.#.#.#.#.###.#.###.#.#.#.#####v#.###.#.#.###.#.#######.#.###.###########.###.#.#.#######.#################.###########.#.#.#.#.#
                                  #.#.....#...#.#.#.#.#.#...#.#...#.#.#...#.>.>.###.#.#...#.#.....#...#...#...#.........###...#...#.....#.......#.........###.........#.#.#...#
                                  #.#.###.#.###.#.#.#.#.#.###.#.###.#.###.#.#######.#.###.#.#####.#.#####.###.#.#################.#.#####.#####.#.###########.#########.#.#####
                                  #.#.#...#.#...#.#.#.#...#...#.###.#.###.#.......#.#.#...#.#.....#.....#.....#.......#...###...#.#.#...#...#...#.###...#...#...........#.#...#
                                  #.#.#.###.#.###.#.#.#####.###.###.#.###.#######.#.#.#.###.#.#########.#############.#.#.###.#.#.#.#.#.###.#.###v###.#.#.#.#############v#.#.#
                                  #.#.#...#.#...#.#.#.....#...#.#...#...#.#...#...#.#.#...#.#.#...#...#...#...........#.#...#.#.#.#.#.#...#.#.#.>.>.#.#.#.#.#.....#...#.>.#.#.#
                                  #.#.###.#.###.#.#.#####.###.#.#.#####.#.#.#.#.###.#.###.#.#.#.#.#.#.###.#.###########.###.#.#.#.#.#.###.#.#.#.###.#.#.#.#.#.###.#.#.#.#v#.#.#
                                  #...###...###...#.......###...#.......#...#...###...###...#...#...#.....#.............###...#...#...###...#...###...#...#...###...#...#...#.#
                                  ###########################################################################################################################################.#
                                  """;
}
