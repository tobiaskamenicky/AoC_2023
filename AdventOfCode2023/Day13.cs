namespace AdventOfCode2023;

public static class Day13
{
    public static void Solve()
    {
        Console.WriteLine("Day 13");
        Console.WriteLine($"Part 1: {Part1()}"); //37718
        Console.WriteLine($"Part 2: {Part2()}"); //40995
    }

    public static long Part1()
    {
        var input = _input.AsSpan();

        var result = 0;
        var start = 0;
        var end = 0;
        foreach (var line in input.EnumerateLines())
        {
            if (!line.IsEmpty)
            {
                end += line.Length + Environment.NewLine.Length;
                continue;
            }

            var pattern = input[start..(end - Environment.NewLine.Length)];
            result += FindReflectionWithTolerance(pattern);

            end += Environment.NewLine.Length;
            start = end;
        }
        var lastPattern = input[start..(end - Environment.NewLine.Length)];
        result += FindReflectionWithTolerance(lastPattern);

        return result;
    }

    public static long Part2()
    {
        var input = _input.AsSpan();

        var result = 0;
        var start = 0;
        var end = 0;
        foreach (var line in input.EnumerateLines())
        {
            if (!line.IsEmpty)
            {
                end += line.Length + Environment.NewLine.Length;
                continue;
            }

            var pattern = input[start..(end - Environment.NewLine.Length)];
            result += FindReflectionWithTolerance(pattern,1);

            end += Environment.NewLine.Length;
            start = end;
        }
        var lastPattern = input[start..(end - Environment.NewLine.Length)];
        result += FindReflectionWithTolerance(lastPattern,1);

        return result;
    }

    private static int FindReflectionWithTolerance(ReadOnlySpan<char> pattern, int tolerance=0)
    {
        var lineLength = pattern.IndexOf(Environment.NewLine[0]);
        var lineWidth = lineLength + Environment.NewLine.Length;
        var lineCount = pattern.Count(Environment.NewLine[0]) + 1;

        for (var i = 0; i < lineCount - 1; i++)
        {
            var mistakes = 0;
            for (var j = 0; i - j >= 0 && j + i + 1 < lineCount; j++)
            {
                for (var k = 0; k < lineLength; k++)
                {
                    if (pattern[(i - j) * lineWidth + k] != pattern[(j + i + 1) * lineWidth + k])
                    {
                        mistakes++;
                        if (mistakes > tolerance)
                        {
                            break;
                        }
                    }
                }

                if (mistakes > tolerance)
                {
                    break;
                }
            }

            if (mistakes == tolerance)
            {
                return (i + 1) * 100;
            }
        }

        for (var i = 0; i < lineLength - 1; i++)
        {
            var mistakes = 0;
            for (var j = 0; i - j >= 0 && j + i + 1 < lineLength; j++)
            {
                for (var k = 0; k < lineCount; k++)
                {
                    if (pattern[k * lineWidth + i - j] != pattern[k * lineWidth + j + i + 1])
                    {
                        mistakes++;
                        if (mistakes > tolerance)
                        {
                            break;
                        }
                    }
                }

                if (mistakes > tolerance)
                {
                    break;
                }
            }

            if (mistakes == tolerance)
            {
                return i + 1;
            }
        }

        return 0;
    }


    private const string _testInput = """
                                      #.##..##.
                                      ..#.##.#.
                                      ##......#
                                      ##......#
                                      ..#.##.#.
                                      ..##..##.
                                      #.#.##.#.

                                      #...##..#
                                      #....#..#
                                      ..##..###
                                      #####.##.
                                      #####.##.
                                      ..##..###
                                      #....#..#
                                      """;

    private const string _input = """
                                  #..###..#####
                                  ###..#.......
                                  .##.#.#.###..
                                  #####....####
                                  #####....####
                                  .##.#.#.###..
                                  ###..#.......
                                  #..###..#####
                                  #.##.##.....#
                                  #########.###
                                  #.##.#..#.###
                                  #.##.#..#.###
                                  #########.###
                                  #.##.##.....#
                                  #.####..#####
                                  ###..#.......
                                  .##.#.#.###..

                                  .....#########.
                                  #.#..#...#..#..
                                  .####...#.#.#..
                                  #####...#.#.#..
                                  #.#..#...#..#..
                                  .....#########.
                                  ###..#....####.
                                  .#...###..#...#
                                  ...#########.#.
                                  ##.##.##.#####.
                                  ##.##.##.#####.
                                  ...#########.#.
                                  .#...###..#...#
                                  ###..#....####.
                                  .....#########.
                                  #.#..#...#..#..
                                  #####...#.#.#..

                                  #.####..#####
                                  .##..##...###
                                  ...##...#####
                                  ##..#.##.....
                                  ..##.#.#.####
                                  .##....######
                                  .#...###.####
                                  ##.##..#.####
                                  #...##.#.....
                                  ...#.###.#..#
                                  #.#...###.##.
                                  ....#..#..##.
                                  ##.......#..#
                                  .#.##..#.####
                                  .#.##..#.####
                                  ##.......#..#
                                  ....#..#..##.

                                  ####.#.
                                  ##.#.##
                                  #..#...
                                  .#.#...
                                  ######.
                                  ...#.#.
                                  ...#.#.
                                  ######.
                                  .#.#...
                                  #.##...
                                  ##.#.##
                                  ####.#.
                                  ###..#.
                                  ##.###.
                                  .....#.
                                  .....#.
                                  ##.###.

                                  ....##...
                                  ..##....#
                                  ...#.#.##
                                  ...#.#.##
                                  ..##....#
                                  ....##...
                                  ##...#..#
                                  ..#.#..#.
                                  ...###..#
                                  ##.####.#
                                  ..#...#..
                                  .#...###.
                                  ...#..#..

                                  .#.######.#....
                                  ##.#....#.##..#
                                  #.##.##.##.####
                                  #.#...#..#.####
                                  ############..#
                                  ...#.##.#......
                                  ...#....#......
                                  ###.#..#.###..#
                                  ..########..##.
                                  .##########....
                                  .#.##..##.#.##.

                                  ##..#.#
                                  ....##.
                                  ##...##
                                  #...###
                                  ..#.###
                                  .##..#.
                                  ...#.#.
                                  ...#.#.
                                  .#...#.
                                  .#...#.
                                  ...#.#.
                                  ...#.#.
                                  .##..#.

                                  .####..###...
                                  ..##.......##
                                  ##..##..#.#..
                                  ........#####
                                  #.##.####..##
                                  #.##.###.#...
                                  ##..##.#.....
                                  #.##.######.#
                                  ..##..##.#.##
                                  #....##..#.##
                                  ##..##...#...
                                  ########.##..
                                  #....####.#..
                                  ..##..#..####
                                  ######.###.##
                                  ######.#.##..
                                  ..##...#..###

                                  ...##.....#..##
                                  ..#..#.....#...
                                  ##.##.##.#..#..
                                  ..#..#...##..##
                                  ..........##...
                                  ..#..#..##..#..
                                  #......###.#...
                                  #..##..#..#.###
                                  ........#.#....
                                  ##....##.#.##..
                                  ##.##.###.#..##
                                  ##....###.##.##
                                  #.####.#.#..#..
                                  .######...##...
                                  ...##..##..#.##
                                  .##..##.#.###..
                                  .#....#.##.##..

                                  .#.##..##.#
                                  ..##.##.##.
                                  ##..#..#..#
                                  .#..####..#
                                  #..........
                                  ..##....##.
                                  ..##....##.
                                  ##..####..#
                                  .##########
                                  #....##....
                                  ..##.##.##.
                                  #..........
                                  #####..####

                                  #....##....
                                  .#....#.#..
                                  ..#...#.###
                                  ###...###..
                                  ....#.#.###
                                  #.#.##.####
                                  ..#######..
                                  .##...#.#..
                                  .##...#.#..
                                  ..#######..
                                  #.#.##.####
                                  ....#.#.###
                                  .##...###..
                                  ..#...#.###
                                  .#....#.#..

                                  .#....##..#
                                  #.#..###..#
                                  #.##...#..#
                                  #..#####..#
                                  ####.#.#..#
                                  .#.###.#..#
                                  ####...#..#
                                  .##.#.#.##.
                                  #....#.####
                                  #.##...#..#
                                  ##..####..#
                                  .###..##..#
                                  .#.#..##..#
                                  ##..####..#
                                  #.##...#..#

                                  #..##.#.#.#..
                                  #..##.#.#.##.
                                  .##..#.....#.
                                  .##..##......
                                  #####..######
                                  #.###.##...##
                                  ...##.#..##..
                                  #.##...#..#.#
                                  ...#..###..##
                                  #.#.##..#.#.#
                                  .....#..#####
                                  #.#...#.#...#
                                  #.#...#.#...#
                                  .....#..#####
                                  #.#.##..#.#.#
                                  ...#..###..##
                                  #.##...#..#.#

                                  #..#.##..####
                                  ####...#.####
                                  .##..#..##..#
                                  .#..#.#.##..#
                                  .###...#.....
                                  #.#.###.#####
                                  #.#.#########

                                  #.##.##.##.##..##
                                  ...#....#...#....
                                  .....##.....#.###
                                  #...####...#.#...
                                  ..#.####.#..#.#..
                                  #....##....####..
                                  #...#..#...#.####
                                  .#.######.#..#.##
                                  ##.#.##.#.#####..
                                  .##......##.#.###
                                  ..###..###....###
                                  ............##...
                                  ###.####.###..###
                                  #..##..##..#.....
                                  .#..#.##..#...#..

                                  .......#..##.##
                                  ..##...#.##.#.#
                                  ##..##.##.#..#.
                                  ##..######...#.
                                  ######..######.
                                  ..##..#.####..#
                                  #.##.#.#.#..##.
                                  ######...##..##
                                  ##########...##
                                  ##..####.##....
                                  ######...##....
                                  ..##..####.##.#
                                  ..##..###.#.#.#

                                  #####.#.######.
                                  #.##.#####.##.#
                                  ...#...#..##.##
                                  .#......#..#.##
                                  .#......#..#.##
                                  ...#...#..##.##
                                  #.##.#####.##.#
                                  #####.#.######.
                                  ....#.####.####
                                  ...####..#.###.
                                  ...####.#.#.###
                                  ...####.#...###
                                  ...####..#.###.

                                  ###..####
                                  ....###.#
                                  ....###.#
                                  #.#.##...
                                  ..#.....#
                                  ..#.....#
                                  #.#.##...
                                  ....###.#
                                  ....###.#
                                  ###..##.#
                                  ....#.#..
                                  ##....##.
                                  .#.#.....
                                  .#.#.....
                                  ##....##.

                                  ....##.
                                  .##....
                                  ..##..#
                                  #.#####
                                  ##.####
                                  ###....
                                  ##.....
                                  ##.####
                                  #.#####
                                  ..##..#
                                  .##....
                                  ....##.
                                  .#..##.
                                  #.#....
                                  .#..##.

                                  ..#..#....##..#
                                  ..#..#......##.
                                  ##....##..#...#
                                  .######.##..##.
                                  ##....###.##..#
                                  .#.##.#...#....
                                  #.####.#.##....

                                  .#.#...#.#.#..#
                                  ...###...##.##.
                                  .##.....#......
                                  .##.....#......
                                  ...###...##.##.
                                  .#.#...#.#.#..#
                                  #..##...###.#..
                                  ..#.#.#.#..###.
                                  ..#.#.#.#..###.
                                  #..##...###.#..
                                  .#.#...#.#.#..#
                                  ...###...##.##.
                                  ###.....#......

                                  ..#..#.#..#
                                  ..#..#.#..#
                                  ###..##...#
                                  ######.#.##
                                  ##....#####
                                  ..##.#.##..
                                  ..##...###.
                                  ...#....###
                                  ..#.##..#..
                                  ##.......##
                                  ##..##...#.
                                  ##..####.##
                                  ##..#.....#
                                  .####..#..#
                                  ..##.....#.

                                  ##..########...
                                  #....###...#...
                                  .......#.#...##
                                  #....##..#.##.#
                                  #######.#..#.##
                                  ..##...##....#.
                                  #.##.#.#.###..#
                                  #.##.##.#.##...
                                  #.##.#.####...#
                                  .#..#..#.#...##
                                  .#..#..#.#...##
                                  #.##.#.####...#
                                  #.##.##.#.##..#

                                  ##.##.###.....#
                                  .....###.###.##
                                  ...#.#.##..##..
                                  ..#.######..#..
                                  ...#.#..#.##.##
                                  ..#..#.###.....
                                  ..##..#....##..

                                  .#.###..##.
                                  .#...#####.
                                  #..##.###.#
                                  ..####.#...
                                  #..#...#...
                                  ####.##..##
                                  ..###......
                                  ..###......
                                  ####.##..##
                                  #..#...#...
                                  ..####.#...
                                  #..##.#.#.#
                                  .#...#####.
                                  .#.###..##.
                                  .#.###..##.

                                  ##..##..#####..
                                  #.##.##..#...#.
                                  #....#.##.#..##
                                  ##..######..###
                                  ..##...##..##..
                                  ..##...##..##..
                                  ##..######..###
                                  #....#.##.#..##
                                  #.##.##..#...#.
                                  ##..##..#####..
                                  ....#.##..##.##
                                  #.##.##.##..##.
                                  .#..#.#..##.###

                                  .#..########..#..
                                  #...#......#...##
                                  .#....####....#..
                                  ######.##.#######
                                  ...##.#..#.##....
                                  #....######.#..##
                                  ###....##....####
                                  ##.###.##.###.###
                                  ##.#..####..#.###
                                  #..##......##..##
                                  #.##...##...##.##
                                  ....########.....
                                  .###.##..##.###..
                                  .##..##..##..##..
                                  ##...#.##.#...###

                                  ..#.##.#....#
                                  ##.#..#.####.
                                  .########..##
                                  #.#.##.#.##.#
                                  ..######....#
                                  #..#..#..##..
                                  #.#.##.#.##.#
                                  .#..##..#..#.
                                  ...#..#......
                                  #...##...##..
                                  #.##..##.##.#
                                  #.######.##.#
                                  ##.#..#.###..

                                  ..#.#####..
                                  ###..#.#.##
                                  ..##..##.#.
                                  ..##..####.
                                  ###..#.#.##
                                  ..#.#####..
                                  ....##.####
                                  ..##.#.....
                                  ..#.##.####
                                  #####...#..
                                  #####......
                                  ###.#.#.#..
                                  ..#...#####

                                  .##.#..#.#..##...
                                  ..#..##.......#..
                                  ###..###.#..##.##
                                  ###.#.#####....##
                                  ....#.###.###.###
                                  ##.#.#...##.##...
                                  ###.#.####.#.#...
                                  ..#.#.###.##..###
                                  ##.#.#.....#.....
                                  .....##.##..#.###
                                  ..#.#..######.###
                                  ..#..##.#####.###
                                  ##..##.##..###.##

                                  ...#...##
                                  .#....###
                                  ..#.#.#..
                                  .#.###.##
                                  .##......
                                  #..#..#..
                                  #...#####
                                  #.#.###..
                                  #.#.#.#..
                                  .##...###
                                  .##...###
                                  ..#.#.#..
                                  #.#.###..

                                  ....####.##..##
                                  #..###.#.#...##
                                  #..###.#.#...##
                                  ....####.##..##
                                  ...##..##.#..#.
                                  ##.##.##....##.
                                  #.#...##...#.##
                                  ..###.....#.#..
                                  #.##.#..###.#..
                                  ...##.#....#..#
                                  #...##.######..
                                  ##.###...#....#
                                  ##.#.##...##..#
                                  ####........###
                                  ####........###
                                  ##.#.##...##..#
                                  #..###...#....#

                                  ..#......#..#..
                                  ..#......#..#..
                                  ##..####..##.##
                                  .##########.#..
                                  .#.#....#.#.###
                                  ##.######.###..
                                  ##.######.##...
                                  ..########.#.##
                                  .#........#...#
                                  ....####......#
                                  ############...
                                  ####.##.####.##
                                  .#.#....#.#.#..

                                  ##..###.#..##
                                  #.##.#.###.#.
                                  #.##.#.###.#.
                                  ##..###.#..##
                                  .....#.#.##..
                                  ........#....
                                  ..##.....#..#
                                  #.##.#.#..#..
                                  .####..#.###.
                                  .####..#.#.##
                                  .####.#....#.

                                  #..#..#.#.###
                                  #...#.##.##.#
                                  ..##....#....
                                  ####..###...#
                                  ####..###...#
                                  ..###...#....
                                  #...#.##.##.#
                                  #..#..#.#.###
                                  ###.##...#...
                                  .##..#.###.##
                                  ..##...##..##
                                  ..#.#..##...#
                                  ..#.#..##...#
                                  ..##...##..##
                                  .##..#.###.##

                                  ##.##..
                                  ...#..#
                                  ...#..#
                                  ##.##..
                                  #.#####
                                  ##.#...
                                  ##.#.##
                                  ..#..##
                                  ####.##

                                  ..#......#.#...
                                  .##......##...#
                                  ##..####..####.
                                  .....##.....###
                                  ##..#..#..##.#.
                                  .#.##..##.#...#
                                  #...#..#...#..#
                                  #...#..#...#..#
                                  .#.##..##.#...#
                                  ##..#..#..##.#.
                                  .....##.....###
                                  ##..####..####.
                                  .##......##...#

                                  #.#..#...
                                  #.#..#...
                                  ...####.#
                                  .##....##
                                  ###....##
                                  ...####.#
                                  #.#..#...

                                  ...#.#.##.#.#..
                                  .#..#......#..#
                                  #.##.#.##.#.##.
                                  #.##.#.##.#.##.
                                  .#..#......#..#
                                  ...#.#.##.#.#..
                                  ..#.#.#..#.#.#.
                                  .#.#...##...#.#
                                  .###.######.###
                                  ####.#....#.###
                                  ...#..####..#..
                                  ..#...#..#...#.
                                  #...#.####.#...
                                  #..##########..
                                  #...##.##.##..#
                                  #...#.#..#.#...
                                  ##.#.######.#.#

                                  ####....###
                                  ###.####.##
                                  ....#..#...
                                  ....####...
                                  ..#......#.
                                  ##...##...#
                                  ..########.
                                  ..###..###.
                                  ..##.##.##.
                                  ####.##.###
                                  ##..####..#
                                  ###..##..##
                                  ..##....##.
                                  ####.##..##
                                  ##...##...#
                                  ####....###
                                  ##..#..#..#

                                  .##.###.###
                                  .##.##..###
                                  .##.##..###
                                  .##.###.###
                                  ...#.#..#.#
                                  ..##...#...
                                  ##.#.#..#.#
                                  #.##..#..#.
                                  ...###...#.
                                  ..#..##....
                                  ..#.##.####
                                  ......##...
                                  ##.#...#..#

                                  ......#..#...
                                  ...#.###.#...
                                  ##.#...###.##
                                  ##.#...###.##
                                  ...#.###.#...
                                  ...#..#..#...
                                  ###.####.#..#
                                  ###.#.#..##..
                                  #######.#.###
                                  ##.##..#.###.
                                  ....##.#.##.#
                                  ###.###.#..#.
                                  ...#####...##

                                  #.##...#.#..###
                                  ##.#..#.#....#.
                                  #..#..#.#....#.
                                  #.##...#.#..###
                                  ##.###.##..#...
                                  ...#......#...#
                                  .#.....#..#.##.
                                  .###..#...#.###
                                  .#...#####..##.
                                  .#...#####..##.
                                  .###..#...#.###
                                  .#.....#..#.##.
                                  ...#......#...#

                                  ...###..##..#
                                  ..###..###..#
                                  ..####.###..#
                                  ...###..##..#
                                  ..#...#.###..
                                  ..#...###.#..
                                  ..#..#.#.....
                                  ##..###.###.#
                                  ...##..#..#.#
                                  ...#..#..##..
                                  ###.##...#.##
                                  ..##.#.#..#..
                                  ..##.####.###

                                  ##.##.##...##..
                                  #.#.#..###.##.#
                                  #.#.#..###.##.#
                                  ##.##.##...##..
                                  #..###..#..##..
                                  ##..##.###.##.#
                                  .#..###...####.
                                  .#.#####.#..#.#
                                  #..#...##.#..#.

                                  ######.
                                  ..#....
                                  ##..#.#
                                  .###.#.
                                  #.#####
                                  ....#.#
                                  ....#.#
                                  #.#####
                                  .#.#.#.
                                  ##..#.#
                                  ..#....
                                  ######.
                                  ######.

                                  ##..#.#....
                                  ##..#.#....
                                  ..#.#.#....
                                  #######.##.
                                  #.###...##.
                                  ###.##..##.
                                  ..#........
                                  .####.#....
                                  #.##...##.#
                                  ####...####
                                  ..##.#..##.
                                  ..#.#......
                                  ..##.#.....

                                  .##.##...
                                  #...#.#..
                                  .##....#.
                                  ........#
                                  #..##..#.
                                  .##.#.#.#
                                  ....#..#.
                                  ####..##.
                                  ####..#.#
                                  ####..#.#
                                  ####..##.

                                  ##..##.#..#.##.
                                  ####..#.##.#..#
                                  ..#.#...##...#.
                                  .#..##.####.##.
                                  #.##..##..##..#
                                  .##.##.#..#.##.
                                  .##....#..#....
                                  #..#####..#####
                                  #.#############
                                  .#..##.####.##.
                                  .#..##.#..#.##.
                                  #..#..#.##.#..#
                                  .######.##.####

                                  .#..#...#####....
                                  #.#.#.#.###...###
                                  .#..##..#.#.#.#.#
                                  .#######..#.#.###
                                  ...#.......######
                                  .##...##.#.##..##
                                  .#.##...###.#.###
                                  .#.##...###.#.###
                                  .##...##.#.##..##

                                  ###..####.#
                                  ###..####..
                                  #....##.#..
                                  #.....#.###
                                  .#.##..###.
                                  .#.##....#.
                                  .##.##..#.#
                                  .#..##.#...
                                  ...#.##.##.
                                  ...#.##.##.
                                  .#..##.#...
                                  .##.##..#.#
                                  .#.##....#.
                                  .#.##..###.
                                  #.....#.###

                                  .#.##.#
                                  #......
                                  .##..##
                                  ...##..
                                  ...##..
                                  .##..##
                                  #......
                                  .######
                                  .#....#
                                  #.#..#.
                                  ###..##
                                  ..#..#.
                                  #......
                                  ##....#
                                  .######
                                  ##....#
                                  .#....#

                                  .#..#.#.##....#
                                  .....#.##...#.#
                                  .....#.##...#.#
                                  .#..#.#.##....#
                                  .####..#..##..#
                                  ...###...##.##.
                                  ..##.#..##..#..
                                  ##..#.#####...#
                                  #.###.#.....#.#
                                  #.#.##.##..##.#
                                  #.#.##.##..##.#
                                  #.###.#.....#.#
                                  ##..#.#####...#
                                  ..##.#..##..#..
                                  ...###...##..#.

                                  ..#.##.###.#.
                                  #..##...#.#..
                                  #.##...#..##.
                                  #.###.##.#...
                                  .#.##....#...
                                  #.##.###..#..
                                  ......#.#.#.#
                                  ......#.#.#.#
                                  #.##.###..#..
                                  .#.##....#...
                                  #.###.##.#...
                                  #.##...#..##.
                                  #..##...#.#.#
                                  ..#.##.###.#.
                                  ..#.##.###.#.

                                  .##.#.#.##.
                                  .##.##....#
                                  .##.##....#
                                  .##.#.#.##.
                                  .##.##.#.##
                                  #..#..#.#..
                                  .....##.##.
                                  .##.##.....
                                  ....###...#
                                  .#####....#
                                  #####.#...#
                                  #####...#..
                                  #..#.#.####
                                  .##.#####.#
                                  .##..##..##

                                  ...##.#..#.
                                  .#.##.####.
                                  .#...#.##.#
                                  #.#########
                                  ..#########
                                  ##...#....#
                                  ##...#.##.#
                                  ..#########
                                  #.#########

                                  ###..##..########
                                  ....#..#.#..####.
                                  #.#..##..#.#....#
                                  ..#..##..#..#..#.
                                  ##.#....#.#######
                                  ###......###....#
                                  .#.##..##.#.####.
                                  #...####...######
                                  .#.#.##.#.#......
                                  ###.####.###....#
                                  #..........#....#
                                  ..#.####.#..#..#.
                                  ...##..##....##..
                                  .#.##..##.#..##..
                                  ...##..##........
                                  .#.#....#.#......
                                  ..##.##.##...##..

                                  ..#.#....##
                                  ......#....
                                  ...#...#.#.
                                  .###..#.#..
                                  .#.#.##..##
                                  #..####..##
                                  #..####..##

                                  ....#...#
                                  ###.#...#
                                  #####..##
                                  #######..
                                  ..#.##.#.
                                  ##..#....
                                  ###..##.#
                                  ###..##.#
                                  ##.##....

                                  ..##.#...#..#
                                  ..#..###..###
                                  ###.....#.#..
                                  ..##..#...#.#
                                  ##....#..##..
                                  ##....#..##..
                                  ..##..#...#.#
                                  ###.....###..
                                  ..#..###..###
                                  ..##.#...#..#
                                  ####...#..###
                                  ..#.##..#..##
                                  ..#...##.#...

                                  ..#..##.##..#.#
                                  #####....#.##..
                                  .#..##..######.
                                  #####...##.####
                                  ..##.#.##....##
                                  ...#####.#.####
                                  ..##..#...#.###
                                  .###..#...#.###
                                  ...#####.#.####
                                  ..##.#.##....##
                                  #####...##.####
                                  .#..##..######.
                                  #####....#.##..
                                  ..#..##.##..#.#
                                  .###..###.#.#.#
                                  .###..###.#.#.#
                                  ..#..##.##..#.#

                                  #...#.#..
                                  #...#.#..
                                  ..##.#...
                                  ##..##...
                                  .#...##..
                                  #..###.##
                                  #.#####..
                                  .#....##.
                                  .#..###..

                                  #..##..#.#...##.#
                                  ......#....####.#
                                  .##.####.######.#
                                  ........####.#..#
                                  #####.#..##.#....
                                  #..##..#.###..#.#
                                  #..####.########.
                                  #..####..#######.
                                  #..##..#.###..#.#
                                  #####.#..##.#....
                                  ........####.#..#

                                  #...##.##.#..
                                  ##.##..###.##
                                  #.######...##
                                  ##.#.########
                                  .#....#......
                                  #.#..##.##...
                                  .##.#.##...##
                                  ##..###.#....
                                  ..####...#.##
                                  .##.####..###
                                  #...##.#.##..
                                  #...##.#.##..
                                  ..#.####..###

                                  #....#.
                                  #.###..
                                  #.###..
                                  #....#.
                                  ..###..
                                  .####..
                                  .....#.
                                  ...#.#.
                                  ####..#
                                  ..###..
                                  #...#..
                                  ......#
                                  ##...#.
                                  ##...#.
                                  ......#
                                  #...#..
                                  ...##..

                                  #..#..#.####.#.
                                  ..#.###.#####..
                                  .....#.###...#.
                                  ..#....#.#.##.#
                                  ..##..##.#.####
                                  ..#####.....#..
                                  ..#####.....#..
                                  .###..##.#.####
                                  ..#....#.#.##.#
                                  .....#.###...#.
                                  ..#.###.#####..
                                  #..#..#.####.#.
                                  .#####.##.#..##
                                  .#####.##.#..##
                                  #..#..#.####.#.

                                  ......#
                                  ..##...
                                  ......#
                                  .#..#.#
                                  ##..###
                                  #....##
                                  ##..##.
                                  ##..###
                                  ##..###
                                  ##..##.
                                  #....##
                                  ##..##.
                                  .#..#.#
                                  ......#
                                  ..##...

                                  #....##.#
                                  .######.#
                                  #.#..##.#
                                  .#.###.##
                                  .#.###.##
                                  #.#..##.#
                                  .######.#
                                  #....##.#
                                  #..###...
                                  ..#.#..#.
                                  #.###.##.
                                  ###.#####
                                  .###..##.
                                  #.###.##.
                                  #.###.##.
                                  .####.##.
                                  ###.#####

                                  .#.##.#.#..#.
                                  .#.##.#.#....
                                  ##.##.##....#
                                  ..###...##..#
                                  ...##....#.##
                                  .....##.##.##
                                  ###.....#.###
                                  .##.###.#..#.
                                  .##.###.#..#.
                                  ###.....#.###
                                  .....##.##.##

                                  ######.######
                                  .##....#...##
                                  #####.#.##...
                                  .##.#.###..##
                                  .....#...#...
                                  #..#####.#.##
                                  #######.#....
                                  .##...#..#.##
                                  ....##..###..
                                  ##.###...#...
                                  .##.##.......
                                  .....#.###...
                                  #####.##...##
                                  .##.......###
                                  .##..##..##..

                                  #......#..#....##
                                  #..##..##....####
                                  #.####.##..#.##.#
                                  ..#..#..#..#..#.#
                                  .#....#..#.##..#.
                                  ##.##.###.##.####
                                  ........#.#...#..
                                  .#....#.##.....#.
                                  ...........##..##
                                  ##.##.#####......
                                  ##..#.##.#..#.##.
                                  #..##..#.#.####.#
                                  #..##..#.#.####.#

                                  .#..#..#..#
                                  .###....###
                                  #..#.##.#..
                                  ####....###
                                  ####....###
                                  #..#.##.#..
                                  .###.##.###

                                  ....#..##..#.....
                                  .##.#......#.##..
                                  .######..###.##..
                                  .......##........
                                  ##.#........#.###
                                  #..#..####..#..##
                                  .##...####...##..
                                  ####........#####
                                  ..###.#..#.###...
                                  .####.####.####..
                                  .#..###..###..#..
                                  .###..####..###..
                                  ..#.#.####.#.#...
                                  ..#.##.##.##.#...
                                  ##....####....###
                                  #.##..####..##.##
                                  ###..#.##.#..####

                                  .##.##.....##
                                  #.#..#...#.#.
                                  ..##...##.###
                                  ..##...##.###
                                  #.#..#...#.#.
                                  .##.##....###
                                  ##..#.....#.#
                                  .#..#..#.####
                                  ....#####.##.
                                  ....#####.##.
                                  .#..#..#.####

                                  #..#..######..#..
                                  .##.#.#....#.#.#.
                                  #.#.#...##...#.#.
                                  .....##....##....
                                  .#.#..#....#..#.#
                                  #.....##..##.....
                                  #.....##..##.....

                                  .####.##.##.##.
                                  ..##...#....#..
                                  .####.#.####.#.
                                  .......######..
                                  ..##...........
                                  #....#...##...#
                                  .####...####...
                                  .......#....#..
                                  ......#.####.#.
                                  ##..###########
                                  ######.##..##.#
                                  .####.#.#..#.#.
                                  ......##....##.
                                  #.##.##########
                                  .......#.####..

                                  #.#....#.#..#
                                  .###..###.#..
                                  .##....##...#
                                  ...#..#....##
                                  #........#.#.
                                  ####..####...
                                  ....##....##.
                                  ....##....##.
                                  ####..####.#.

                                  .###.#.###..#
                                  .....#####.##
                                  .#.##.##..##.
                                  ...##..#.##..
                                  ######...#...
                                  ######...#...
                                  ...##..#.##..
                                  .#.##.##..##.
                                  .....#####.##
                                  .###.#.###..#
                                  ###...##.#.#.
                                  ..#..##.#.#.#
                                  ###.#..#...#.
                                  #.##.##.#..##
                                  #.##.##.#..##
                                  ###.#..#...#.
                                  .....##.#.#.#

                                  ...#..#.#.#
                                  #...#.#..##
                                  ...#.#.#.#.
                                  #.###...#..
                                  ....#...##.
                                  ....#...##.
                                  #.###...#..
                                  ...###.#.#.
                                  #...#.#..##
                                  ...#..#.#.#
                                  .#...###...
                                  ####....#..
                                  ####....#..
                                  .#...###...
                                  ...#..#.#.#
                                  #...#.#..##
                                  ...###.#.#.

                                  .#...#.
                                  .#...#.
                                  #...#..
                                  ##.#..#
                                  #####.#
                                  ..#....
                                  ##...##
                                  ##...##
                                  #.#....
                                  #####.#
                                  ##.#..#
                                  #...#..
                                  .#...#.

                                  .....###......#
                                  .##...#...#....
                                  #..##..##.###..
                                  ....##.#....#.#
                                  #####...###....
                                  .##..##....#.#.
                                  #..#..#..#...##
                                  ####.#.#####.#.
                                  .##...##....#..
                                  ....#.##.#####.
                                  ....#.##.#####.
                                  .##...##...##..
                                  ####.#.#####.#.
                                  #..#..#..#...##
                                  .##..##....#.#.
                                  #####...###....
                                  ....##.#....#.#

                                  .##..##..#.
                                  .######..#.
                                  #.####.##..
                                  #.#....#.#.
                                  .######.##.
                                  #..##..#..#
                                  ###..###.##
                                  #..##..#...
                                  .#.##.#..#.
                                  #.####.#...
                                  .######..#.
                                  #########.#
                                  #.####.#...
                                  .#.##.#..##
                                  .######.##.
                                  .######.##.
                                  .#.##.#..##

                                  #.#....###....#
                                  #.#.####.######
                                  .####.#...#..#.
                                  #....#..#######
                                  ##.#.#....####.
                                  #####..#.######
                                  #####..#.######
                                  ##.#.#....####.
                                  #.......#######

                                  .#..##.##
                                  #.....###
                                  .##.#.###
                                  #..#.#...
                                  #..##..##
                                  ...##....
                                  #...#..##
                                  .####.#..
                                  ##..#####
                                  .#....#..
                                  .#..#....
                                  ......#..
                                  ......#..
                                  .#..#....
                                  .#...##..
                                  ##..#####
                                  .####.#..

                                  ...##############
                                  ..##.....##......
                                  #.....###.##.##.#
                                  #.#.##.#####....#
                                  ##.#....#.....#..
                                  #...#..##.#.####.
                                  .##.#..#.##.#..#.
                                  #...##..#..#....#
                                  #...##..#..#....#

                                  .##.#####
                                  #...#..#.
                                  #.#..##.#
                                  ##....#..
                                  .#..##.#.
                                  .#..##.#.
                                  ##....#..
                                  #.#..##.#
                                  #...#..#.
                                  ..#.#####
                                  .##.#.##.
                                  ..#..#.##
                                  #####..#.
                                  #####..#.
                                  ..#..#.##

                                  .#.#......#.#..
                                  #..########..##
                                  .####....####..
                                  #..###..###..##
                                  #.##..##..##.##
                                  ..#........#...
                                  .############..
                                  #..#.#..#.#..##
                                  ##.########.###
                                  .##.###.##.##..
                                  .#....##....#..
                                  ###...##...####
                                  ##..##..##..###

                                  .##.#..#..#..
                                  .......#..#..
                                  .###.#.####.#
                                  ..####.#..#.#
                                  ......######.
                                  .#####.#..#.#
                                  .##..########
                                  ..##.#.#..#.#
                                  ....###....#.
                                  #...#..#..#..
                                  #...#..#..#..

                                  ##..#..#.
                                  ##..#..#.
                                  #.###.##.
                                  #..#...##
                                  .#.#...##
                                  .##....##
                                  ....##..#
                                  ....##..#
                                  .##....##
                                  .#.#...##
                                  #..#...#.

                                  ##.##.#..
                                  ..#....#.
                                  ######.##
                                  ..####.#.
                                  ....#.##.
                                  ###.###..
                                  ..###.#.#
                                  ##...#.##
                                  ..##.#.##
                                  ##..#..#.
                                  ..#.###.#
                                  ....#..##
                                  ..#...##.
                                  ..###.##.
                                  ..#.##...
                                  ###.#.###
                                  ###.#####

                                  ##..##..#
                                  .##.#.#.#
                                  ...#.##..
                                  #..#.##..
                                  .#####...
                                  ..##.####
                                  ..#..####
                                  ..#..####
                                  ..##.####

                                  ...####....
                                  ##......###
                                  #.#....#.##
                                  #.######.##
                                  #..#..#..##
                                  #.##..##.##
                                  ##..##..#..

                                  .....##.###..###.
                                  #....##.###..###.
                                  .##....##.####.##
                                  .#.##.#####..####
                                  #.....#.###..###.
                                  ##..#.#..#.##.#..
                                  ##.#.....#....#..
                                  #.#.#.##..####..#
                                  ####..###.#..#.##

                                  .#..##.#.#####.
                                  .#..##.#.#####.
                                  #..#.#.###.#...
                                  .#.#.#.##..#...
                                  ..#...#.#...##.
                                  ......#.####.##
                                  ###...##.#..###
                                  ##....##.#..###
                                  ......#.####.##

                                  #.###.#
                                  ####...
                                  .#....#
                                  .#....#
                                  ####...
                                  #.###.#
                                  #.###..
                                  ###.###
                                  .....##
                                  .##..##
                                  ###...#
                                  ##....#
                                  .##..##
                                  .....##
                                  ###.###

                                  #.##.##.##.#..#
                                  ..##....##..###
                                  .####..####...#
                                  .####..####..##
                                  #.##.##.##.#..#
                                  ############.#.
                                  ############...
                                  #.##.##.##.#...
                                  ############...
                                  #.##.##.##.#.##
                                  .####..####.##.
                                  ##..####..##...
                                  #.##.##.##.####
                                  #....##....###.
                                  ############.#.
                                  ............###
                                  ..###..###..##.

                                  .#..#.#.#.#.#....
                                  #########.##.####
                                  #########.##.####
                                  .#..#.#.#.#.##...
                                  #.##.#.#..#.#....
                                  ..#####.#.#..#...
                                  .##.#.#...##.#...
                                  ...###.#.##..#...
                                  #.....###....#.#.
                                  ..#..####.##..##.
                                  #.#..#...####....
                                  #.#..#...####....
                                  ..#..####.##..##.
                                  #.....###....#.#.
                                  ...###.#.##..#...
                                  .##.#.#...##.#...
                                  ..#####.#.#..#...

                                  .##.##.##..##
                                  ...####..##..
                                  #..#.....##..
                                  .##.##.#.##.#
                                  ####.#...##..
                                  #..#####.##.#
                                  .##.#.#.#..#.
                                  ######.######
                                  ....#.##.##.#

                                  .#######..#..
                                  ...#.#.#...##
                                  ...#.#.#....#
                                  .#######..#..
                                  .#######..#..
                                  ...#.#.#....#
                                  ...#.#.#...##
                                  .#######..#..
                                  .#..#.#.##.#.
                                  ....####.....
                                  #..##.#.#####
                                  ##...########
                                  .##.#...#..#.

                                  ..#..##..##
                                  ..#..##..##
                                  ##...#.#.#.
                                  #.#.#.#....
                                  .###..####.
                                  ##.#.....##
                                  ..#.#.##..#
                                  ...#...##..
                                  #########.#
                                  #####.###.#
                                  ...#...##..
                                  ..#.#.##..#
                                  ##.#.....##
                                  .###..####.
                                  #.#.#.#....
                                  """;
}
